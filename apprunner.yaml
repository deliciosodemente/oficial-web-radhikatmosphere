version: 1.0
runtime: python3
build:
  commands:
    build:
      - pip install -r requirements.txt
run:
  runtime-version: 3.8
  command: uvicorn backend.main:app --host 0.0.0.0 --port 8080
  network:
    port: 8080
  env:
    - name: CORS_ORIGINS
      value: "https://*.cloudfront.net"
    - name: ENVIRONMENT
      value: "production"
instance:
  cpu: 1
  memory: 2048
  instance-role-arn: arn:aws:iam::${AWS_ACCOUNT_ID}:role/AppRunnerServiceRole
health_check:
  path: "/"
  timeout: 5
  interval: 10
  healthy_threshold: 1
  unhealthy_threshold: 5
auto_scaling:
  min_size: 1
  max_size: 10
  target_concurrent_requests: 100